@model KulturSanatPortal.Web.Models.Home.MiniCalendarVm
@using System.Globalization
@{
    var tr = new CultureInfo("tr-TR");
    var prev = new DateTime(Model.Year, Model.Month, 1).AddMonths(-1);
    var next = new DateTime(Model.Year, Model.Month, 1).AddMonths(1);
    var names = new[] { "Pzt", "Sal", "Çar", "Per", "Cum", "Cts", "Paz" }; // Pazartesi ile başlar
}
<div class="card p-2 calendar-mini compact glass shadowed mb-4">
    <div class="d-flex align-items-center justify-content-between mb-2">
        <a class="btn btn-sm btn-outline-light" asp-controller="Home" asp-action="Index" asp-route-y="@prev.Year" asp-route-m="@prev.Month"><i class="bi bi-chevron-left"></i></a>
        <div class="fw-semibold">@(new DateTime(Model.Year, Model.Month, 1).ToString("MMMM yyyy", tr))</div>

        <a class="btn btn-sm btn-outline-light" asp-controller="Home" asp-action="Index" asp-route-y="@next.Year" asp-route-m="@next.Month"><i class="bi bi-chevron-right"></i></a>
    </div>

    <table class="table table-dark table-sm table-borderless align-middle text-center mb-0">
        <thead>
            <tr class="small text-secondary">
                @foreach (var h in names)
                {
                    <th class="py-1">@h</th>
                }
            </tr>
        </thead>
        <tbody>
            @{
                for (int r = 0; r < 6; r++)
                {
                    <tr>
                        @for (int c = 0; c < 7; c++)
                        {
                            var d = Model.Days[r * 7 + c];
                            var muted = d.InMonth ? "" : "text-secondary-50";
                            var today = d.IsToday ? "today" : "";
                            <td class="@muted p-1">
                                <div class="day @today">
                                    <div class="small fw-semibold">@d.DateLocal.Day</div>
                                    @if (d.Count > 0)
                                    {
                                        <a class="badge text-bg-primary position-absolute end-0 bottom-0 me-1 mb-1 text-decoration-none"
                                           asp-controller="Events" asp-action="Day"
                                           asp-route-year="@d.DateLocal.Year" asp-route-month="@d.DateLocal.Month" asp-route-day="@d.DateLocal.Day">
                                            @d.Count
                                        </a>
                                    }
                                </div>
                            </td>
                        }
                    </tr>
                }
            }
        </tbody>
    </table>
    <div class="mt-2 small text-secondary">
        <span class="badge text-bg-primary me-1">n</span> o günkü etkinlik sayısı • güne tıklayınca liste açılır.
    </div>
</div>
